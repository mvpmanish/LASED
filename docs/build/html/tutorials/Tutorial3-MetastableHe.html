

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Tutorial 3: He Excitation: Initialisation with Data and Angular Shape &mdash; LASED 0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial 4: Hyperfine Structure of Sodium D2 Line" href="Tutorial4-SodiumDLine.html" />
    <link rel="prev" title="Tutorial 2: D to P Exciation in Helium" href="Tutorial2-HeRotation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> LASED
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Tutorial1-SimpleCalcium.html">Tutorial 1: The Basics with Simple Calcium</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial2-HeRotation.html">Tutorial 2: D to P Exciation in Helium</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tutorial 3: He Excitation: Initialisation with Data and Angular Shape</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Setting-up-the-System">Setting up the System</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Initialisating-the-Laser-Atom-System-with-Data">Initialisating the Laser-Atom System with Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Time-Evolution">Time Evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-and-Saving-Data">Plotting and Saving Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-the-Angular-Shape">Plotting the Angular Shape</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial4-SodiumDLine.html">Tutorial 4: Hyperfine Structure of Sodium D2 Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial5-Rubidium85DLine.html">Tutorial 5: Rubidium-85 D Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial6-Caesium133DLine.html">Tutorial 6: Caesium-133 D Line</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">LASED</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LASED</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Tutorial 3: He Excitation: Initialisation with Data and Angular Shape</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/Tutorial3-MetastableHe.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Tutorial-3:-He-Excitation:-Initialisation-with-Data-and-Angular-Shape">
<h1>Tutorial 3: He Excitation: Initialisation with Data and Angular Shape<a class="headerlink" href="#Tutorial-3:-He-Excitation:-Initialisation-with-Data-and-Angular-Shape" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial a more relaistic system will be simulated which could be the process in an experiment and the angular shape of the electron cloud will be plotted and a video of the angular shape of the electron cloud over time will be plotted. Let’s say that helium is excited to the 3D-state via electron impact from its ground state whilst a laser excites these electron-excited atoms into a high-lying 10P-state. A level diagram of the system is shown below.</p>
<img alt="HeMetastableStateExcitation" src="../_images/HeMetastableStateExcitation.png" />
<p>Let’s import all the libraries needed. We will need a library to read in data from a datafile. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is a good library to do this.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">LASED</span> <span class="k">as</span> <span class="nn">las</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span> <span class="c1"># This is to display html images in a notebook</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1">#This librray is used to read in the data</span>
</pre></div>
</div>
</div>
<div class="section" id="Setting-up-the-System">
<h2>Setting up the System<a class="headerlink" href="#Setting-up-the-System" title="Permalink to this headline">¶</a></h2>
<p>This is a very similar system to last tutorial except for the lifetime and laser wavelength. Both of these values are taken from looking at the transition on the National Institute of Standards and Technology’s (NIST) atomic database. The page for He can be found
<a class="reference external" href="https://physics.nist.gov/cgi-bin/ASD/lines1.pl?spectra=He+I&amp;limits_type=0&amp;low_w=&amp;upp_w=&amp;unit=1&amp;submit=Retrieve+Data&amp;de=0&amp;format=0&amp;line_out=0&amp;en_unit=0&amp;output=0&amp;bibrefs=1&amp;page_size=15&amp;show_obs_wl=1&amp;show_calc_wl=1&amp;unc_out=1&amp;order_out=0&amp;max_low_enrg=&amp;show_av=3&amp;max_upp_enrg=&amp;tsb_value=0&amp;min_str=&amp;A_out=0&amp;intens_out=on&amp;max_str=&amp;allowed_out=1&amp;forbid_out=1&amp;min_accur=&amp;min_intens=&amp;conf_out=on&amp;term_out=on&amp;enrg_out=on&amp;J_out=on">here</a>. The 10P state data is found
<a class="reference external" href="https://physics.nist.gov/cgi-bin/ASD/lines1.pl?spectra=He%20I&amp;limits_type=0&amp;unit=1&amp;submit=Retrieve%20Data&amp;de=0&amp;format=0&amp;line_out=0&amp;en_unit=1&amp;output=0&amp;bibrefs=1&amp;page_size=15&amp;show_obs_wl=1&amp;show_calc_wl=1&amp;unc_out=1&amp;order_out=0&amp;show_av=3&amp;tsb_value=0&amp;A_out=0&amp;intens_out=on&amp;allowed_out=1&amp;forbid_out=1&amp;conf_out=on&amp;term_out=on&amp;enrg_out=on&amp;J_out=on&amp;level_id=002001.000187">here</a> and the 3D data is found
<a class="reference external" href="https://physics.nist.gov/cgi-bin/ASD/lines1.pl?spectra=He%20I&amp;limits_type=0&amp;unit=1&amp;submit=Retrieve%20Data&amp;de=0&amp;format=0&amp;line_out=0&amp;en_unit=1&amp;output=0&amp;bibrefs=1&amp;page_size=15&amp;show_obs_wl=1&amp;show_calc_wl=1&amp;unc_out=1&amp;order_out=0&amp;show_av=3&amp;tsb_value=0&amp;A_out=0&amp;intens_out=on&amp;allowed_out=1&amp;forbid_out=1&amp;conf_out=on&amp;term_out=on&amp;enrg_out=on&amp;J_out=on&amp;level_id=002001.000016">here</a>.</p>
<p>To calculate the total lifetime for <span class="math notranslate nohighlight">\(\tau_f\)</span> and <span class="math notranslate nohighlight">\(\tau_b\)</span> sum the decay rates <span class="math notranslate nohighlight">\(A_{ki}\)</span> for each transition from the upper state and lower state to states not in the laser-excitation and then take the reciprocal of this to get the total lifetime. For example, <span class="math notranslate nohighlight">\(\tau_f\)</span> for the 10P state of He has many decays to lower states however the largest decay rates will contribute the most so the first three are</p>
<div class="math notranslate nohighlight">
\[\tau_f = \frac{1}{\Gamma_{f, total}} \approx \frac{1}{\Gamma_{f,1}+\Gamma_{f,2}+\Gamma_{f,3}}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tau</span> <span class="o">=</span> <span class="mf">80.7e3</span> <span class="c1"># lifetime in ns (take from NIST 1/A_ki as this is in rad/s)</span>
<span class="n">tau_f</span> <span class="o">=</span> <span class="mf">59.6</span> <span class="c1"># lifetime of upper state to other states in ns</span>
<span class="n">tau_b</span> <span class="o">=</span> <span class="mf">15.7</span> <span class="c1"># lifetime of lower state decay to other states in ns</span>
<span class="n">laser_wavelength</span> <span class="o">=</span> <span class="mf">900e-9</span> <span class="c1"># wavelength of laser 3D to 9P state from NIST</span>

<span class="n">w_e</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">angularFreq</span><span class="p">(</span><span class="n">laser_wavelength</span><span class="p">)</span>  <span class="c1"># Converted to angular frequency in Grad/s</span>

<span class="c1"># Create states for J = 2 -&gt; J = 1</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">two</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">three</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">four</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">five</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">six</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w_e</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">seven</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w_e</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">eight</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w_e</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>

<span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">,</span> <span class="n">three</span><span class="p">,</span> <span class="n">four</span><span class="p">,</span> <span class="n">five</span><span class="p">]</span> <span class="c1"># ground states</span>
<span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="n">six</span><span class="p">,</span> <span class="n">seven</span><span class="p">,</span> <span class="n">eight</span><span class="p">]</span> <span class="c1"># excited states</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># laser radiation polarisation</span>

<span class="c1"># Simulation parameters</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">stop_time</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1"># in ns</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">201</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>

<span class="c1"># Laser parameters</span>
<span class="n">laser_intensity</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># laser intensity in mW/mm^2</span>
</pre></div>
</div>
</div>
<p>Next, make the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">helium_system</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">LaserAtomSystem</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">laser_wavelength</span><span class="p">,</span> <span class="n">tau_f</span> <span class="o">=</span> <span class="n">tau_f</span><span class="p">,</span>
                                 <span class="n">tau_b</span> <span class="o">=</span> <span class="n">tau_b</span><span class="p">,</span> <span class="n">laser_intensity</span> <span class="o">=</span> <span class="n">laser_intensity</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Initialisating-the-Laser-Atom-System-with-Data">
<h2>Initialisating the Laser-Atom System with Data<a class="headerlink" href="#Initialisating-the-Laser-Atom-System-with-Data" title="Permalink to this headline">¶</a></h2>
<p>Now, we need to extract the data from the datafile. This is scattering amplitude data kindly given by Igor Brey who has calculated these amplitudes from a model. The model is quite accurate for helium and gives amplitudes for various impact angles.</p>
<p>Igor calculated electron impact excitation amplitudes for all angles to the 3<span class="math notranslate nohighlight">\(^1\)</span>D<span class="math notranslate nohighlight">\(_2\)</span> state. With this data we can generate an initial density matrix to excite from real data. The data was generated in the collison frame.</p>
<p>The density matrix elements correspond to <span class="math notranslate nohighlight">\(\rho_{M,M'} = \sum_{m'}{\langle}Mm'_f|\rho_f|M'm'_f{\rangle} = {\langle}f(M)f^*(M'){\rangle}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(f(M)\)</span> is the scattering amplitude for state <span class="math notranslate nohighlight">\(|J M \rangle\)</span>.</p>
<p>Select data from the scattering angle of 45 degrees.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scat_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Igor31DAmplitudes.csv&quot;</span><span class="p">)</span>
<span class="n">scat_angle_data</span> <span class="o">=</span> <span class="n">scat_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scat_data</span><span class="p">[</span><span class="s1">&#39;Angle&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">45</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scat_angle_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    Angle  Re a(+2)*1e-12  Im(a+2)*1e-12  Re a(+1)*1e-12  Im(a+1)*1e-12  \
45     45           8.821           19.5           14.84         -35.66

    Re a(0)*1e-12  Im(a0)*1e-12  Re(a-1)*1e-12  Im(a-1)*1e-12  Re(a-2)*1e-12  \
45          85.82        -12.27         -14.84          35.66          8.821

    Im(a-2)*1e-12
45           19.5
</pre></div></div>
</div>
<p>Now we have read in what values the amplitudes are and we can now obtain the diagonal density matrix elements. First, put the scattering amplitudes in variables and put them into a list.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f_2</span> <span class="o">=</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Re a(+2)*1e-12&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Im(a+2)*1e-12&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.</span><span class="n">j</span>
<span class="n">f_1</span> <span class="o">=</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Re a(+1)*1e-12&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Im(a+1)*1e-12&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.</span><span class="n">j</span>
<span class="n">f_0</span> <span class="o">=</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Re a(0)*1e-12&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Im(a0)*1e-12&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.</span><span class="n">j</span>
<span class="n">f_minus1</span> <span class="o">=</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Re(a-1)*1e-12&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Im(a-1)*1e-12&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.</span><span class="n">j</span>
<span class="n">f_minus2</span> <span class="o">=</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Re(a-2)*1e-12&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">scat_angle_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;Im(a-2)*1e-12&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.</span><span class="n">j</span>
<span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="n">f_minus2</span><span class="p">,</span> <span class="n">f_minus1</span><span class="p">,</span> <span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">,</span> <span class="n">f_2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Now, calculate the density matrix <span class="math notranslate nohighlight">\(\rho\)</span>. Normalise the populations so that tr(𝜌) = 1.</p>
<p><strong>Note</strong>: The density matrix created must be in the order with the value of <span class="math notranslate nohighlight">\(\rho_{-m, -m}\)</span> starting the upper left-hand side of the matrix to <span class="math notranslate nohighlight">\(\rho_{m, m}\)</span> at the bottom right-hand corner. <span class="math notranslate nohighlight">\(m\)</span> is the projection of the total angular momentum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho_collision</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">population</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">population</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="n">rho_collision</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="c1"># Normalisation</span>
<span class="n">norm</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)):</span>
    <span class="n">norm</span> <span class="o">+=</span> <span class="n">rho_collision</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
<span class="n">rho_collision</span> <span class="o">=</span> <span class="n">rho_collision</span><span class="o">/</span><span class="n">norm</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The J = 2 density matrix in the collision frame is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">rho_collision</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The J = 2 density matrix in the collision frame is
                     0                   1                   2  \
0  0.040126+0.000000j -0.049448+0.052905j  0.045355+0.156080j
1 -0.049448-0.052905j  0.130688+0.000000j  0.149895-0.252136j
2  0.045355-0.156080j  0.149895+0.252136j  0.658372+0.000000j
3  0.049448+0.052905j -0.130688+0.000000j -0.149895+0.252136j
4  0.040126+0.000000j -0.049448+0.052905j  0.045355+0.156080j

                    3                   4
0  0.049448-0.052905j  0.040126+0.000000j
1 -0.130688+0.000000j -0.049448-0.052905j
2 -0.149895-0.252136j  0.045355-0.156080j
3  0.130688+0.000000j  0.049448+0.052905j
4  0.049448-0.052905j  0.040126+0.000000j
</pre></div></div>
</div>
<p><strong>Note</strong>: Above <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is used to convert the matrix into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> just for display purposes and the display of a matrix as a DataFrame is neater and the indeces are easier to read.</p>
<p>Now, we must initialise the density matrix of the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code> with this calculated ground state density matrix. To do this, we can use the function <code class="docutils literal notranslate"><span class="pre">appendDensityMatrixToRho_0(density_rho,</span> <span class="pre">state_type)</span></code> where: * <code class="docutils literal notranslate"><span class="pre">rho_0</span></code> is a column vector which is of size n<span class="math notranslate nohighlight">\(^2\)</span>, where n is the number of energy levels in the system. This column vector represents the denisty matrix for the laser-atom system. It is flattened (one-dimensional) as it is easier to solve the equations of motion
generated with this form. It is in the form of:</p>
<div class="math notranslate nohighlight">
\[\rho_{flattened} = \begin{bmatrix} \rho_{11} \cr \rho_{12} \cr . \cr . \cr \rho_{1n} \cr \rho_{21} \cr . \cr . \cr \rho_{nn}\end{bmatrix}\]</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">density_rho</span></code> is the density matrix of the ground or upper state density matrix to be input into the flattened coupled denisty matrix and then initialised as <code class="docutils literal notranslate"><span class="pre">rho_0</span></code> in the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code>. This is of type <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>. This is a usual 2D matrix.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state_type</span></code> is a character of ‘e’ or ‘g’ for appending the excited state density matrix or ‘g’ for the ground state density matrix.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">rho_0</span></code> is already initialised as empty with the correct size when a <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code> is initialised.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">helium_system</span><span class="o">.</span><span class="n">appendDensityMatrixToRho_0</span><span class="p">(</span><span class="n">rho_collision</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The initial ρ for the laser-atom system is: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">rho_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The initial ρ for the laser-atom system is:
 [[ 0.04012626+0.j        ]
 [ 0.0494475 -0.05290513j]
 [ 0.04535541+0.15607978j]
 [-0.0494475 +0.05290513j]
 [ 0.04012626+0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.0494475 +0.05290513j]
 [ 0.1306877 +0.j        ]
 [-0.1498946 +0.25213635j]
 [-0.1306877 +0.j        ]
 [ 0.0494475 +0.05290513j]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.04535541-0.15607978j]
 [-0.1498946 -0.25213635j]
 [ 0.65837208+0.j        ]
 [ 0.1498946 +0.25213635j]
 [ 0.04535541-0.15607978j]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [-0.0494475 -0.05290513j]
 [-0.1306877 +0.j        ]
 [ 0.1498946 -0.25213635j]
 [ 0.1306877 +0.j        ]
 [-0.0494475 -0.05290513j]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.04012626+0.j        ]
 [ 0.0494475 -0.05290513j]
 [ 0.04535541+0.15607978j]
 [-0.0494475 +0.05290513j]
 [ 0.04012626+0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]
 [ 0.        +0.j        ]]
</pre></div></div>
</div>
</div>
<div class="section" id="Time-Evolution">
<h2>Time Evolution<a class="headerlink" href="#Time-Evolution" title="Permalink to this headline">¶</a></h2>
<p>Model the polarisation at 30<span class="math notranslate nohighlight">\(^{\circ}\)</span> to the QA so rotate the system, then time evolve, and then rotate back.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rotate by (90°, 30°, -90°)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">theta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">helium_system</span><span class="o">.</span><span class="n">rotateRho_0</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Time evolve:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">helium_system</span><span class="o">.</span><span class="n">timeEvolution</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Rotate back:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Rotate by (90°, -30°, -90°)</span>
<span class="n">helium_system</span><span class="o">.</span><span class="n">rotateRho_t</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plotting-and-Saving-Data">
<h2>Plotting and Saving Data<a class="headerlink" href="#Plotting-and-Saving-Data" title="Permalink to this headline">¶</a></h2>
<p>Now, save and plot the data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">helium_system</span><span class="o">.</span><span class="n">saveToCSV</span><span class="p">(</span><span class="s2">&quot;SavedData/MetastableHeBrey1500mW.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho_66</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">six</span><span class="p">,</span> <span class="n">six</span><span class="p">)]</span>
<span class="n">rho_77</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">seven</span><span class="p">,</span> <span class="n">seven</span><span class="p">)]</span>
<span class="n">rho_88</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">eight</span><span class="p">,</span> <span class="n">eight</span><span class="p">)]</span>

<span class="n">fig_upper</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_66</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_66 (Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_77</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_77(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_88</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_88(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Upper Atomic Populations: He 10&lt;sup&gt;1&lt;/sup&gt;P&lt;sub&gt;1&lt;/sub&gt; to 3&lt;sup&gt;1&lt;/sup&gt;D&lt;sub&gt;2&lt;/sub&gt;, I = </span><span class="si">{:0.0f}</span><span class="s2">mW, π-polarised 30° to QA&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">laser_intensity</span><span class="p">,</span> <span class="n">tau</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">tau_f</span><span class="o">/</span><span class="mf">1e3</span><span class="p">),</span>
                 <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                 <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">,</span>
                <span class="n">font</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial3-HeFigUpper.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial3-HeFigUpper.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial3-MetastableHe_23_0.png" src="../_images/tutorials_Tutorial3-MetastableHe_23_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho11</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">one</span><span class="p">)]</span>
<span class="n">rho22</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">two</span><span class="p">,</span> <span class="n">two</span><span class="p">)]</span>
<span class="n">rho33</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">three</span><span class="p">,</span> <span class="n">three</span><span class="p">)]</span>
<span class="n">rho44</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">four</span><span class="p">,</span> <span class="n">four</span><span class="p">)]</span>
<span class="n">rho55</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">five</span><span class="p">)]</span>


<span class="n">fig_lower</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho11</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_11 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho22</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_22 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho33</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_33 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho44</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_44 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gold&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho55</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_55 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Lower Atomic Populations: He 10&lt;sup&gt;1&lt;/sup&gt;P&lt;sub&gt;1&lt;/sub&gt;, I = </span><span class="si">{:0.0f}</span><span class="s2">mW, π-polarised 30° to QA&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">laser_intensity</span><span class="p">,</span> <span class="n">tau</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">tau_f</span><span class="o">/</span><span class="mf">1e3</span><span class="p">),</span>
                        <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                        <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">)</span>

<span class="n">fig_lower</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial3-HeFigLower.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial3-HeFigLower.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial3-MetastableHe_24_0.png" src="../_images/tutorials_Tutorial3-MetastableHe_24_0.png" />
</div>
</div>
</div>
<div class="section" id="Plotting-the-Angular-Shape">
<h2>Plotting the Angular Shape<a class="headerlink" href="#Plotting-the-Angular-Shape" title="Permalink to this headline">¶</a></h2>
<p>We can plot the angular “shape” of the states <span class="math notranslate nohighlight">\(W(\theta, \phi)\)</span> as they evolve over time <a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.77.013409">Murray 2008</a>:</p>
<div class="math notranslate nohighlight">
\[W(\theta, \phi) = \sum_{m_J, m_J'}\rho_{m_J, m_J'}Y_{J, m_J}(\theta, \phi)Y^*_{J,m_J'}(\theta, \phi)\]</div>
<p>where <span class="math notranslate nohighlight">\(Y_{J, m_J}(\theta, \phi)\)</span> are the spherical harmonics for the state with total angular momentum <span class="math notranslate nohighlight">\(J\)</span> and projection <span class="math notranslate nohighlight">\(m_J\)</span>.</p>
<p><strong>Note</strong>: this only works for a single angular momentum state so will not produce the correct results for multiple <span class="math notranslate nohighlight">\(F\)</span>-states but will be correct for a single <span class="math notranslate nohighlight">\(J\)</span>-state.</p>
<p>In LASED we can plot the initial shape of the atomic state using the <code class="docutils literal notranslate"><span class="pre">angularShape_0()</span></code> function which takes the argument of <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">phi</span></code> lists for the azimuthal (0 to 2<span class="math notranslate nohighlight">\(\pi\)</span>) and polar coordinates (0 to <span class="math notranslate nohighlight">\(\pi\)</span>) respectively as well as a <code class="docutils literal notranslate"><span class="pre">state</span></code> argument which equals either “g” or “e” depending on whether the angular shape of the excited or lower state in the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem()</span></code> will be calculated. The “angular shape” is the radius of the electron charge cloud as the
azimuthal and polar coordinate are varied.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">angularShape_0</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The angular shape can now be plotted using the plotting package desired. Here, I use <code class="docutils literal notranslate"><span class="pre">Plotly</span></code>. Before plotting, a mesh grid must be made for <code class="docutils literal notranslate"><span class="pre">theta</span></code> and <code class="docutils literal notranslate"><span class="pre">phi</span></code> and these must be converted to cartesian coordinates along with the radial coordinate calculated. A helpful function is the <code class="docutils literal notranslate"><span class="pre">SphericalToCartesian</span></code> function which is provided by <code class="docutils literal notranslate"><span class="pre">LASED</span></code> which takes the meshgrid and radius as inputs and provides x,y,z coordinates to be plotted.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>  <span class="c1"># Create a mesh grid using numpy</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">SphericalToCartesian</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>  <span class="c1"># Create cartesian coords</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)])</span>  <span class="c1"># Plot the result</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial3-HeAngularShapeDStatet=0.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial3-HeAngularShapeDStatet=0.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial3-MetastableHe_28_0.png" src="../_images/tutorials_Tutorial3-MetastableHe_28_0.png" />
</div>
</div>
<p>We can make a video for the evolution of the 3D-state’s electron cloud as it evolves over time in the laser-atom system. To do this, we have to generate the angular shape of the time evolution using the function <code class="docutils literal notranslate"><span class="pre">angularShape_t</span></code> which gives an array of angular shapes. Each angular shape must then be plotted and the images saved. Once all the images are saved they must be stitched together to create a video file. This can be done using any software package, <code class="docutils literal notranslate"><span class="pre">ffmpeg</span></code> is used here.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">W_t</span> <span class="o">=</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">angularShape_t</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="c1"># Generate the images</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">W</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">W_t</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">SphericalToCartesian</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    <span class="c1"># Plot the result</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)])</span>
    <span class="n">camera</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">up</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">center</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">eye</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">1.5</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">scene_camera</span><span class="o">=</span><span class="n">camera</span><span class="p">)</span>

    <span class="n">filenumber</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%0.5d</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">i</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Videos/3DShape&quot;</span> <span class="o">+</span> <span class="n">filenumber</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Generate mp4 using ffpmeg</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span>
        <span class="s1">&#39;ffmpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;-framerate&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;Videos/3DShape</span><span class="si">%05d</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="s1">&#39;-pix_fmt&#39;</span><span class="p">,</span> <span class="s1">&#39;yuv420p&#39;</span><span class="p">,</span>
        <span class="s1">&#39;He3DState1500mWCollFrame30deg.mp4&#39;</span>
    <span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Tutorial4-SodiumDLine.html" class="btn btn-neutral float-right" title="Tutorial 4: Hyperfine Structure of Sodium D2 Line" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Tutorial2-HeRotation.html" class="btn btn-neutral float-left" title="Tutorial 2: D to P Exciation in Helium" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Manish.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>