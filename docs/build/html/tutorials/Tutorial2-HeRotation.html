

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Tutorial 2: D to P Exciation in Helium &mdash; LASED 0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial 3: He Excitation: Initialisation with Data and Angular Shape" href="Tutorial3-MetastableHe.html" />
    <link rel="prev" title="Tutorial 1: The Basics with Simple Calcium" href="Tutorial1-SimpleCalcium.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> LASED
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Tutorial1-SimpleCalcium.html">Tutorial 1: The Basics with Simple Calcium</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tutorial 2: D to P Exciation in Helium</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Decay-to-Other-States">Decay to Other States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Rotation">Rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Polarisation-Angle">Polarisation Angle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial3-MetastableHe.html">Tutorial 3: He Excitation: Initialisation with Data and Angular Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial4-SodiumDLine.html">Tutorial 4: Hyperfine Structure of Sodium D2 Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial5-Rubidium85DLine.html">Tutorial 5: Rubidium-85 D Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial6-Caesium133DLine.html">Tutorial 6: Caesium-133 D Line</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">LASED</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LASED</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Tutorial 2: D to P Exciation in Helium</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/Tutorial2-HeRotation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Tutorial-2:-D-to-P-Exciation-in-Helium">
<h1>Tutorial 2: D to P Exciation in Helium<a class="headerlink" href="#Tutorial-2:-D-to-P-Exciation-in-Helium" title="Permalink to this headline">¶</a></h1>
<p>This tutorial demonstrates how to set up an excitation from a D state to a P state for Helium. The Helium D-state we are considering is now not the ground state of the atom so decay can occur to lower states. The upper P-state can also decay to other states non-radiatively which can also be modelled. In this tutorial the decay to other states is modelled.</p>
<p>The use of simultaneous polarisations and the normalisation of the half-Rabi frequencies is demonstrated here as well.</p>
<p>Also, the Wigner-D matrices are used to rotate the system to a different reference frame to show that this model is physically consistent in all reference frames.</p>
<p>Start by importing the libraries we will be using.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">LASED</span> <span class="k">as</span> <span class="nn">las</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span> <span class="c1"># This is to display html images in a notebook</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
</pre></div>
</div>
</div>
<div class="section" id="Decay-to-Other-States">
<h2>Decay to Other States<a class="headerlink" href="#Decay-to-Other-States" title="Permalink to this headline">¶</a></h2>
<p>To set up a Laser-Atom system you must first declare the atomic states which you want to work with and label them. We are going to set up an example system for a D-state to a P-state transistion for helium where the P-state is a high principle quantum number Rydberg state. Therefore, we will assume that the wavelength of this fictitious transition is the ionisation energy of helium as this is a very high lying Rydberg state. This system is only for example purposes only and does not exist.</p>
<img alt="HeRydbergDtoP" src="../_images/HeRydbergDtoP.png" />
<p>A level diagram of the system we will model is shown above.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code> is setup in the code block below. The decay (e.g. non-radiative decay) to other states outside the system from the excited state is characterised by the arrow from the upper states to state <span class="math notranslate nohighlight">\(|f\rangle\)</span>. This can be modelled into the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code> using the keyword <code class="docutils literal notranslate"><span class="pre">tau_f</span></code> and inputting the lifetime of this decay. The decay to other states from the lower state is shown in the diagram by the arrow from the lower state to the state <span class="math notranslate nohighlight">\(|b\rangle\)</span>. This can
be modelled using the keyword <code class="docutils literal notranslate"><span class="pre">tau_b</span></code> and inputting the lifetime of this decay.</p>
<p>We will excite this system with simultaneous right-hand circular and left-hand circular polarised light in the natural frame with the laser beam travelling down the quantisation axis. This will be linearly-polarised light in the collision frame where the transverse E-field of the laser is oscillating along the quantisation axis. Therefore, we must set <code class="docutils literal notranslate"><span class="pre">Q</span> <span class="pre">=</span> <span class="pre">[-1,</span> <span class="pre">1]</span></code> and set the <code class="docutils literal notranslate"><span class="pre">rabi_factors</span></code> to <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">-1]</span></code> as noted in Tutorial 1 and scale the Rabi frequency in the system by using
<code class="docutils literal notranslate"><span class="pre">rabi_scaling</span></code>. In this case set it to <span class="math notranslate nohighlight">\(1/{\sqrt{2}}\)</span>.</p>
<p>Then, we create the sub-states and put them into either the ground or excited states.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># System parameters</span>
<span class="n">laser_wavelength</span> <span class="o">=</span> <span class="mf">900e-9</span> <span class="c1"># wavelength of transition</span>
<span class="n">w_e</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">angularFreq</span><span class="p">(</span><span class="n">laser_wavelength</span><span class="p">)</span>

<span class="c1"># Create states</span>
<span class="n">one</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">two</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">three</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">four</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">five</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">six</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w_e</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">seven</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w_e</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">eight</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w_e</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">,</span> <span class="n">three</span><span class="p">,</span> <span class="n">four</span><span class="p">,</span> <span class="n">five</span><span class="p">]</span> <span class="c1"># ground states</span>
<span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="n">six</span><span class="p">,</span> <span class="n">seven</span><span class="p">,</span> <span class="n">eight</span><span class="p">]</span> <span class="c1"># excited states</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># laser radiation polarisation</span>
<span class="n">rabi_scaling_he</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rabi_factors_he</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">laser_intensity</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># mW/mm^2</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">60e3</span> <span class="c1"># lifetime in ns (estimated)</span>
<span class="n">tau_f</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># non-radiative lifetime of rydberg upper state to other high-lying states (ns)</span>
<span class="n">tau_b</span> <span class="o">=</span> <span class="mi">5000</span>  <span class="c1"># non-radiatuve lifetime of metastable D-state (ns)</span>
</pre></div>
</div>
</div>
<p>Set the simulation time for 1000 ns every 1 ns as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Simulation parameters</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">stop_time</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># in ns</span>
<span class="n">time_steps</span> <span class="o">=</span> <span class="mi">1001</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">stop_time</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Create the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code> object. To set the initial conditions of the density matrix at t = 0 ns <span class="math notranslate nohighlight">\(\rho(t = 0)\)</span> we can use the <code class="docutils literal notranslate"><span class="pre">setRho_0(s1,</span> <span class="pre">s2,</span> <span class="pre">val)</span></code> where <code class="docutils literal notranslate"><span class="pre">s1</span></code> and <code class="docutils literal notranslate"><span class="pre">s2</span></code> are <code class="docutils literal notranslate"><span class="pre">State</span></code> objects denoting the element of the density matrix to be set as <span class="math notranslate nohighlight">\(\rho_{s1,s2}\)</span> and <code class="docutils literal notranslate"><span class="pre">val</span></code> denotes the value assigned to this element.</p>
<p>For this system we have set the populations of states <span class="math notranslate nohighlight">\(|1\rangle\)</span>, <span class="math notranslate nohighlight">\(|3\rangle\)</span>, and <span class="math notranslate nohighlight">\(|5\rangle\)</span> as 1/3. So the density matrix elements <span class="math notranslate nohighlight">\(\rho_{11}\)</span> = <span class="math notranslate nohighlight">\(\rho_{33}\)</span> = <span class="math notranslate nohighlight">\(\rho_{55}\)</span> = 1/3.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">helium_system</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">LaserAtomSystem</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">laser_wavelength</span><span class="p">,</span>
                                    <span class="n">laser_intensity</span> <span class="o">=</span> <span class="n">laser_intensity</span><span class="p">,</span> <span class="n">rabi_scaling</span> <span class="o">=</span> <span class="n">rabi_scaling_he</span><span class="p">,</span>
                                    <span class="n">rabi_factors</span> <span class="o">=</span> <span class="n">rabi_factors_he</span><span class="p">)</span>
<span class="n">helium_system_tauf</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">LaserAtomSystem</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">laser_wavelength</span><span class="p">,</span>
                                         <span class="n">tau_f</span> <span class="o">=</span> <span class="n">tau_f</span><span class="p">,</span>
                                    <span class="n">laser_intensity</span> <span class="o">=</span> <span class="n">laser_intensity</span><span class="p">,</span> <span class="n">rabi_scaling</span> <span class="o">=</span> <span class="n">rabi_scaling_he</span><span class="p">,</span>
                                    <span class="n">rabi_factors</span> <span class="o">=</span> <span class="n">rabi_factors_he</span><span class="p">)</span>
<span class="n">helium_system_tauf_taub</span> <span class="o">=</span> <span class="n">las</span><span class="o">.</span><span class="n">LaserAtomSystem</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">laser_wavelength</span><span class="p">,</span>
                                         <span class="n">tau_f</span> <span class="o">=</span> <span class="n">tau_f</span><span class="p">,</span> <span class="n">tau_b</span> <span class="o">=</span> <span class="n">tau_b</span><span class="p">,</span>
                                    <span class="n">laser_intensity</span> <span class="o">=</span> <span class="n">laser_intensity</span><span class="p">,</span> <span class="n">rabi_scaling</span> <span class="o">=</span> <span class="n">rabi_scaling_he</span><span class="p">,</span>
                                    <span class="n">rabi_factors</span> <span class="o">=</span> <span class="n">rabi_factors_he</span><span class="p">)</span>
<span class="n">helium_system</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">three</span><span class="p">,</span> <span class="n">three</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">five</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system_tauf</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system_tauf</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">three</span><span class="p">,</span> <span class="n">three</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system_tauf</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">five</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system_tauf_taub</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system_tauf_taub</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">three</span><span class="p">,</span> <span class="n">three</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">helium_system_tauf_taub</span><span class="o">.</span><span class="n">setRho_0</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">five</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Time evolve the system.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">helium_system</span><span class="o">.</span><span class="n">timeEvolution</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">helium_system_tauf</span><span class="o">.</span><span class="n">timeEvolution</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">helium_system_tauf_taub</span><span class="o">.</span><span class="n">timeEvolution</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, we can plot the populations using <code class="docutils literal notranslate"><span class="pre">Plotly</span></code> (or any other plotting package).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho_66</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">six</span><span class="p">,</span> <span class="n">six</span><span class="p">)]</span>
<span class="n">rho_66_tauf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system_tauf</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">six</span><span class="p">,</span> <span class="n">six</span><span class="p">)]</span>
<span class="n">rho_66_tauf_taub</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">helium_system_tauf_taub</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">six</span><span class="p">,</span> <span class="n">six</span><span class="p">)]</span>

<span class="n">fig_upper</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_66</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_66&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_66_tauf</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_66 with 1us tau_f&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_66_tauf_taub</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_66 with 1us tau_f &amp; 5us tau_b&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                       <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;D to P Excitation: Effect of other decays&quot;</span><span class="p">,</span>
                     <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                     <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">,</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeLifetimes.png&quot;</span><span class="p">)</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeLifetimes.svg&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeLifetimes.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial2-HeRotation_12_0.png" src="../_images/tutorials_Tutorial2-HeRotation_12_0.png" />
</div>
</div>
</div>
<div class="section" id="Rotation">
<h2>Rotation<a class="headerlink" href="#Rotation" title="Permalink to this headline">¶</a></h2>
<p>With <code class="docutils literal notranslate"><span class="pre">LASED</span></code> we can rotate density matrices to different reference frames using the Wigner-D matrix.</p>
<p><strong>Note</strong>: The Wigner-D matrix is only defined for J-represenattion (when isospin I = 0) and therefore when in F-representation the rotation may not be correct. Also, density matrices can only be rotated for single atomic states so the optical coherences between ground and excited states cannot be rotated. To obtain optical coherences in a different reference frame the initial density matrix (at t = 0) must be rotated and time evolved with the polarisation rotated to that frame.</p>
<p>The rotation is defined by Euler angles <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, <code class="docutils literal notranslate"><span class="pre">beta</span></code>, and <code class="docutils literal notranslate"><span class="pre">gamma</span></code>. The frame is rotated with each angle in succession so that: - <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is the rotation (in radians) around the initial z-axis to obtain the new frame Z’ - <code class="docutils literal notranslate"><span class="pre">beta</span></code> is the rotation (in radians) about the new y’-axis to obtain the new frame Z’’ - <code class="docutils literal notranslate"><span class="pre">gamma</span></code> is the rotation (in radians) about the new z’’-axis to obtain the final frame</p>
<p>In <code class="docutils literal notranslate"><span class="pre">LASED</span></code> to rotate the initial density matrix use <code class="docutils literal notranslate"><span class="pre">rotateRho_0(alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma)</span></code> on the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code>. In this he lium system the atom is changed to be defined in the collision frame from the natural frame so the polarisation is changed to be purely linear with <code class="docutils literal notranslate"><span class="pre">Q</span> <span class="pre">=</span> <span class="pre">[0]</span></code> and scaled to 1.</p>
<p><strong>Note</strong>: To simulate a linear polarisation with an angle with respect to the x-axis we can initialise the density matrix in that frame, rotate to the collision frame (with the polarisation aligned with the x-axis, time evolve the system, and then rotate back to the frame where the polarisation is at an angle.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>  <span class="c1"># Angles are in radians</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">helium_system_rot</span> <span class="o">=</span> <span class="n">helium_system</span>
<span class="n">helium_system_rot</span><span class="o">.</span><span class="n">rotateRho_0</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="n">helium_system_rot</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">helium_system_rot</span><span class="o">.</span><span class="n">rabi_scaling</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">helium_system_rot</span><span class="o">.</span><span class="n">rabi_factors</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Now, we can time evolve this system in this new reference frame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">helium_system_rot</span><span class="p">)</span>
<span class="n">helium_system_rot</span><span class="o">.</span><span class="n">timeEvolution</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LaserAtomSystem([6, 7, 8], [1, 2, 3, 4, 5], 60000.0, [0], [1, 0, -1], 9e-07, None, 100, None)
</pre></div></div>
</div>
<p>Now we can plot what the populations look like.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">las_sys</span> <span class="o">=</span> <span class="n">helium_system_rot</span>
<span class="n">rho_66</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">six</span><span class="p">,</span> <span class="n">six</span><span class="p">)]</span>
<span class="n">rho_77</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">seven</span><span class="p">,</span> <span class="n">seven</span><span class="p">)]</span>
<span class="n">rho_88</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">eight</span><span class="p">,</span> <span class="n">eight</span><span class="p">)]</span>

<span class="n">fig_upper</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_66</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_66 (Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_77</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_77(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_88</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_88(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Laser Frame Upper Atomic Populations: J = 2 to J = 1 Helium&quot;</span><span class="p">,</span>
                 <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                 <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">,</span>
                <span class="n">font</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigUpperCollFrame.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigUpperCollFrame.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial2-HeRotation_18_0.png" src="../_images/tutorials_Tutorial2-HeRotation_18_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho11</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">one</span><span class="p">)]</span>
<span class="n">rho22</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">two</span><span class="p">,</span> <span class="n">two</span><span class="p">)]</span>
<span class="n">rho33</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">three</span><span class="p">,</span> <span class="n">three</span><span class="p">)]</span>
<span class="n">rho44</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">four</span><span class="p">,</span> <span class="n">four</span><span class="p">)]</span>
<span class="n">rho55</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">five</span><span class="p">)]</span>


<span class="n">fig_lower</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho11</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_11 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho22</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_22 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho33</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_33 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho44</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_44 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gold&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho55</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_55 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Lower Atomic Populations&quot;</span><span class="p">,</span>
                        <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                 <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">)</span>

<span class="n">fig_lower</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigLowerCollFrame.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigLowerCollFrame.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial2-HeRotation_19_0.png" src="../_images/tutorials_Tutorial2-HeRotation_19_0.png" />
</div>
</div>
<p>If we rotate the time-evolved density matrix <code class="docutils literal notranslate"><span class="pre">rho_t</span></code> back to the natural frame we should get the same populations as when we evolved in the natural frame as the excitation must be the same in all reference frames. We can do this rotation by using <code class="docutils literal notranslate"><span class="pre">rotateRho_t</span></code> on the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem</span></code>.</p>
<p><strong>Note</strong>: A message will be thrown saying that the optical coherences are not rotated.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">helium_system_rot</span><span class="o">.</span><span class="n">rotateRho_t</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we can plot the results and obtain the same plots as in the first time evolution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">las_sys</span> <span class="o">=</span> <span class="n">helium_system_rot</span>
<span class="n">rho_66</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">six</span><span class="p">,</span> <span class="n">six</span><span class="p">)]</span>
<span class="n">rho_77</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">seven</span><span class="p">,</span> <span class="n">seven</span><span class="p">)]</span>
<span class="n">rho_88</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">eight</span><span class="p">,</span> <span class="n">eight</span><span class="p">)]</span>

<span class="n">fig_upper</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_66</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_66 (Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_77</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_77(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_88</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_88(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Natural Frame Upper Atomic Populations: J = 2 to J =1 Helium&quot;</span><span class="p">,</span>
                 <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                 <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">,</span>
                <span class="n">font</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigUpperRotatedToNatFrame.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigUpperRotatedToNatFrame.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial2-HeRotation_23_0.png" src="../_images/tutorials_Tutorial2-HeRotation_23_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rho11</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">one</span><span class="p">)]</span>
<span class="n">rho22</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">two</span><span class="p">,</span> <span class="n">two</span><span class="p">)]</span>
<span class="n">rho33</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">three</span><span class="p">,</span> <span class="n">three</span><span class="p">)]</span>
<span class="n">rho44</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">four</span><span class="p">,</span> <span class="n">four</span><span class="p">)]</span>
<span class="n">rho55</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">five</span><span class="p">,</span> <span class="n">five</span><span class="p">)]</span>


<span class="n">fig_lower</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho11</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_11 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho22</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_22 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho33</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_33 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho44</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_44 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gold&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho55</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_55 (Lower State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>
<span class="n">fig_lower</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Lower Atomic Populations&quot;</span><span class="p">,</span>
                        <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                 <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">)</span>

<span class="n">fig_lower</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigLowerRotatedToNatFrame.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HeFigLowerRotatedToNatFrame.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial2-HeRotation_24_0.png" src="../_images/tutorials_Tutorial2-HeRotation_24_0.png" />
</div>
</div>
</div>
<div class="section" id="Polarisation-Angle">
<h2>Polarisation Angle<a class="headerlink" href="#Polarisation-Angle" title="Permalink to this headline">¶</a></h2>
<p>The polarisation angle in <code class="docutils literal notranslate"><span class="pre">LASED</span></code> is assumed to be 0 during excitation i.e. the polarisation vector is in the same direction as the quantisation axis (QA). To model a non-zero polarisation angle with respect to the QA the <code class="docutils literal notranslate"><span class="pre">LaserAtomSystem()</span></code> must be rotated by the polarisation angle <span class="math notranslate nohighlight">\(\theta\)</span> to the frame where the polarisation is in the direction of the QA, time evolved using <code class="docutils literal notranslate"><span class="pre">timeEvolution()</span></code> and then rotated back to the old frame (so rotate by -<span class="math notranslate nohighlight">\(\theta\)</span>).</p>
<p>As an example, the Helium system will be excited by liner light polarised at an angle of <span class="math notranslate nohighlight">\(30^{\circ}\)</span> to the QA. To do this rotate the He system by <span class="math notranslate nohighlight">\((\alpha, \beta, \gamma)\)</span> = (90<span class="math notranslate nohighlight">\(^{\circ}\)</span>, 30<span class="math notranslate nohighlight">\(^{\circ}\)</span>, -90<span class="math notranslate nohighlight">\(^{\circ}\)</span>), excite with polarisation <code class="docutils literal notranslate"><span class="pre">Q</span> <span class="pre">=</span> <span class="pre">[0]</span></code>, and then rotate the system back to the old reference frame by performing the rotation (90<span class="math notranslate nohighlight">\(^{\circ}\)</span>, -30<span class="math notranslate nohighlight">\(^{\circ}\)</span>, -90<span class="math notranslate nohighlight">\(^{\circ}\)</span>).</p>
<p>Rotate the Helium system and time evolve using a linear polarisation:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">theta</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># Polarisation angle</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>  <span class="c1"># Convert to radians</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>

<span class="c1"># Set up the laser-atom system</span>
<span class="n">helium_system_polarisation_angle</span> <span class="o">=</span> <span class="n">helium_system_rot</span>
<span class="n">helium_system_polarisation_angle</span><span class="o">.</span><span class="n">rotateRho_0</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

<span class="c1"># Time evolve and plot</span>
<span class="n">helium_system_polarisation_angle</span><span class="o">.</span><span class="n">timeEvolution</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

<span class="c1"># Rotate rho_t back to the original reference frame (the optical coherences will not be preserved)</span>
<span class="n">helium_system_polarisation_angle</span><span class="o">.</span><span class="n">rotateRho_t</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="o">-</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">las_sys</span> <span class="o">=</span> <span class="n">helium_system_polarisation_angle</span>
<span class="n">rho_66</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">six</span><span class="p">,</span> <span class="n">six</span><span class="p">)]</span>
<span class="n">rho_77</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">seven</span><span class="p">,</span> <span class="n">seven</span><span class="p">)]</span>
<span class="n">rho_88</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">rho</span> <span class="ow">in</span> <span class="n">las_sys</span><span class="o">.</span><span class="n">Rho_t</span><span class="p">(</span><span class="n">eight</span><span class="p">,</span> <span class="n">eight</span><span class="p">)]</span>

<span class="n">fig_upper</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_66</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_66 (Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                            <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_77</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_77(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span>
                                 <span class="n">y</span> <span class="o">=</span> <span class="n">rho_88</span><span class="p">,</span>
                                 <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Rho_88(Upper State)&quot;</span><span class="p">,</span>
                                    <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
                                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
                           <span class="p">)))</span>

<span class="n">fig_upper</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Upper Atomic Populations: J = 2 to J = 1 Helium with </span><span class="si">{</span><span class="n">theta</span><span class="si">}</span><span class="s2">° Polarisation Angle&quot;</span><span class="p">,</span>
                 <span class="n">xaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Time (ns)&quot;</span><span class="p">,</span>
                 <span class="n">yaxis_title</span> <span class="o">=</span> <span class="s2">&quot;Population&quot;</span><span class="p">,</span>
                <span class="n">font</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">fig_upper</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HePolarisationAngle.png&quot;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;SavedPlots/tutorial2-HePolarisationAngle.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Tutorial2-HeRotation_28_0.png" src="../_images/tutorials_Tutorial2-HeRotation_28_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Tutorial3-MetastableHe.html" class="btn btn-neutral float-right" title="Tutorial 3: He Excitation: Initialisation with Data and Angular Shape" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Tutorial1-SimpleCalcium.html" class="btn btn-neutral float-left" title="Tutorial 1: The Basics with Simple Calcium" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Manish.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>